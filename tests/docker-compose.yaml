version: "3.7"
services:
  pocs:
    image: panoptes-pocs:latest
    build:
      context: ../
      dockerfile: docker/Dockerfile
      args:
        pip_install_extras: '[google,focuser,sensors,testing]'
    init: true
    tty: true
    environment:
      - PANDIR=/panoptes-pocs
      - POCS=/panoptes-pocs
      - PANOPTES_CONFIG_FILE=/panoptes-pocs/tests/testing.yaml
      - PANOPTES_CONFIG_HOST=localhost
      - PANOPTES_CONFIG_PORT=8765
    privileged: true
    network_mode: host
    command: [ "pytest" ]
    volumes:
      - "$PWD/logs:/panoptes-pocs/logs"
      - "$PWD/build:/panoptes-pocs/build"
