version: '3.7'
services:
  weather-plotter:
    image: gcr.io/panoptes-survey/pocs
    container_name: weather-plotter
    privileged: true
    network_mode: host
    env_file: "${PANDIR:-/var/panoptes}/env_file"
    depends_on:
      - "messaging-hub"
    volumes:
      - pandir:/var/panoptes
    command: /bin/zsh -ic "python scripts/plot_weather.py -f /var/panoptes/json_store/panoptes/weather.json --interval 300"
  peas-shell:
    image: gcr.io/panoptes-survey/pocs
    container_name: peas-shell
    privileged: true
    network_mode: host
    env_file: "${PANDIR:-/var/panoptes}/env_file"
    depends_on:
      - "messaging-hub"
    volumes:
      - pandir:/var/panoptes
    # No-op to keep machine running, use $POCS/bin/peas-shell to access
    command: tail -f /dev/null
  pocs-shell:
    image: gcr.io/panoptes-survey/pocs
    container_name: pocs-shell
    privileged: true
    network_mode: host
    env_file: "${PANDIR:-/var/panoptes}/env_file"
    depends_on:
      - "peas-shell"
    volumes:
      - pandir:/var/panoptes
    # No-op to keep machine running, use $POCS/bin/pocs-shell to access
    command: tail -f /dev/null
volumes:
    pandir:
      driver: local
      driver_opts:
        type: none
        device: /var/panoptes
        o: bind

